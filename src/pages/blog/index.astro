---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import Navbar from '@components/Navbar.astro';
import BlogTile from '@components/BlogTile.astro';

const allPosts = await getCollection('blog');
// Filter out archived posts (explicit boolean check)
const activePosts = allPosts.filter((post) => post.data.archived !== true);
const sortedPosts = activePosts.sort((a, b) => 
  b.data.date.getTime() - a.data.date.getTime()
);
---

<BaseLayout title="Engineering Log | Nikhil R. Nigam">
  <Navbar />

  <div class="page-header">
    <h1>Engineering Log</h1>
    <p class="page-subtitle">Deep dives into system design, ML infrastructure, and production engineering.</p>
  </div>

  <div class="blog-grid">
    {sortedPosts.map((post) => (
      <BlogTile
        title={post.data.title}
        date={post.data.date}
        description={post.data.description}
        tags={post.data.tags}
        readingTime={post.data.readingTime}
        url={`/blog/${post.slug}`}
      />
    ))}
  </div>

  <div style="padding-bottom: 6rem;"></div>
</BaseLayout>

<style>
  .blog-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 2rem;
  }

  @media (max-width: 768px) {
    .blog-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

